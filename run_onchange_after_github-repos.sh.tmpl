#!/bin/bash
{{ if eq (len .chezmoi.hostname) 8 }}
# This machine is using the current naming convention! yay!
case ${HOSTNAME:0:1} in
  C) formFactor="console";;
  D) formFactor="desktop";;
  L) formFactor="laptop";;
  P) formFactor="phone";;
  S) formFactor="server";;
  V) formFactor="VM";;
  *) formFactor="unknown";;
esac 
{{ else }}
# This machine definitely isn't using our naming convention.
formFactor="unknown"
{{ end }}

# Personal projects
if [ ! -d ~/Projects/halley ]
then
  git clone https://github.com/mimuki/halley ~/Projects/halley
fi

if [ "$formFactor" != "server" ]; then
  # Talon
  if [ ! -d ~/.talon/user/rango-talon ]; then
    # Chezmoi was too eager and added our config before we cloned
    # so we have to do this little dance 
    mv ~/.talon/user/community ~/.talon/user/temp
    git clone https://github.com/talonhub/community ~/.talon/user/community
    mv -f ~/.talon/user/temp/* ~/.talon/user/community/
    rm ~/.talon/user/temp -rf

    git clone https://github.com/david-tejada/rango-talon ~/.talon/user/rango-talon

    git clone https://github.com/cursorless-dev/cursorless-talon ~/.talon/user/cursorless-talon
  fi
fi
